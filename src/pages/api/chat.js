import { default as axios } from 'axios';\n\nexport default async (req, res) => {\n  if (req.method === 'POST') {\n    const { apiKey, messages } = req.body;\n    try {\n      const { data } = await axios.post(\n        'https://api.openai.com/v1/engines/davinci-codex/completions',\n        {\n          prompt: messages.map((message) => message.role + ': ' + message.text).join('\n') + '\nAssistant:',\n          max_tokens: 150,\n          n: 1,\n          stop: null,\n          temperature: 0.5,\n        },\n        {\n          headers: {\n            'Authorization': `Bearer ${apiKey}`,\n            'Content-Type': 'application/json',\n          },\n        }\n      );\n\n      res.status(200).json(data);\n    } catch (error) {\n      res.status(500).json({ error: 'Error in the API request', details: error.message });\n    }\n  } else {\n    res.status(405).json({ error: 'Method not allowed' });\n  }\n};